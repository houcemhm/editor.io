{"ast":null,"code":"import _get from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _possibleConstructorReturn from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";\nimport _classCallCheck from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _wrapNativeSuper from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js\";\nimport _createForOfIteratorHelper from \"D:/github/editor.io/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nvar buttonSelectors = ['[data-md-button]', 'md-header', 'md-bold', 'md-italic', 'md-quote', 'md-code', 'md-link', 'md-image', 'md-unordered-list', 'md-ordered-list', 'md-task-list', 'md-mention', 'md-ref', 'md-strikethrough'];\nfunction getButtons(toolbar) {\n  var els = [];\n  var _iterator = _createForOfIteratorHelper(toolbar.querySelectorAll(buttonSelectors.join(', '))),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var button = _step.value;\n      if (button.hidden || button.offsetWidth <= 0 && button.offsetHeight <= 0) continue;\n      if (button.closest('markdown-toolbar') === toolbar) els.push(button);\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  return els;\n}\nfunction keydown(fn) {\n  return function (event) {\n    if (event.key === ' ' || event.key === 'Enter') {\n      event.preventDefault();\n      fn(event);\n    }\n  };\n}\nvar styles = new WeakMap();\nvar MarkdownButtonElement = /*#__PURE__*/function (_HTMLElement) {\n  _inherits(MarkdownButtonElement, _HTMLElement);\n  var _super = _createSuper(MarkdownButtonElement);\n  function MarkdownButtonElement() {\n    var _this;\n    _classCallCheck(this, MarkdownButtonElement);\n    _this = _super.call(this);\n    var apply = function apply() {\n      var style = styles.get(_assertThisInitialized(_this));\n      if (!style) return;\n      applyStyle(_assertThisInitialized(_this), style);\n    };\n    _this.addEventListener('keydown', keydown(apply));\n    _this.addEventListener('click', apply);\n    return _this;\n  }\n  _createClass(MarkdownButtonElement, [{\n    key: \"connectedCallback\",\n    value: function connectedCallback() {\n      if (!this.hasAttribute('role')) {\n        this.setAttribute('role', 'button');\n      }\n    }\n  }, {\n    key: \"click\",\n    value: function click() {\n      var style = styles.get(this);\n      if (!style) return;\n      applyStyle(this, style);\n    }\n  }]);\n  return MarkdownButtonElement;\n}( /*#__PURE__*/_wrapNativeSuper(HTMLElement));\nvar MarkdownHeaderButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen) {\n  _inherits(MarkdownHeaderButtonElement, _MarkdownButtonElemen);\n  var _super2 = _createSuper(MarkdownHeaderButtonElement);\n  function MarkdownHeaderButtonElement() {\n    var _this2;\n    _classCallCheck(this, MarkdownHeaderButtonElement);\n    _this2 = _super2.call(this);\n    var level = parseInt(_this2.getAttribute('level') || '3', 10);\n    if (level < 1 || level > 6) {\n      return _possibleConstructorReturn(_this2);\n    }\n    var prefix = \"\".concat('#'.repeat(level), \" \");\n    styles.set(_assertThisInitialized(_this2), {\n      prefix: prefix\n    });\n    return _this2;\n  }\n  return _createClass(MarkdownHeaderButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-header')) {\n  window.MarkdownHeaderButtonElement = MarkdownHeaderButtonElement;\n  window.customElements.define('md-header', MarkdownHeaderButtonElement);\n}\nvar MarkdownBoldButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen2) {\n  _inherits(MarkdownBoldButtonElement, _MarkdownButtonElemen2);\n  var _super3 = _createSuper(MarkdownBoldButtonElement);\n  function MarkdownBoldButtonElement() {\n    var _this3;\n    _classCallCheck(this, MarkdownBoldButtonElement);\n    _this3 = _super3.call(this);\n    styles.set(_assertThisInitialized(_this3), {\n      prefix: '**',\n      suffix: '**',\n      trimFirst: true\n    });\n    return _this3;\n  }\n  _createClass(MarkdownBoldButtonElement, [{\n    key: \"connectedCallback\",\n    value: function connectedCallback() {\n      _get(_getPrototypeOf(MarkdownBoldButtonElement.prototype), \"connectedCallback\", this).call(this);\n      this.setAttribute('hotkey', 'b');\n    }\n  }]);\n  return MarkdownBoldButtonElement;\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-bold')) {\n  window.MarkdownBoldButtonElement = MarkdownBoldButtonElement;\n  window.customElements.define('md-bold', MarkdownBoldButtonElement);\n}\nvar MarkdownItalicButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen3) {\n  _inherits(MarkdownItalicButtonElement, _MarkdownButtonElemen3);\n  var _super4 = _createSuper(MarkdownItalicButtonElement);\n  function MarkdownItalicButtonElement() {\n    var _this4;\n    _classCallCheck(this, MarkdownItalicButtonElement);\n    _this4 = _super4.call(this);\n    styles.set(_assertThisInitialized(_this4), {\n      prefix: '_',\n      suffix: '_',\n      trimFirst: true\n    });\n    return _this4;\n  }\n  _createClass(MarkdownItalicButtonElement, [{\n    key: \"connectedCallback\",\n    value: function connectedCallback() {\n      _get(_getPrototypeOf(MarkdownItalicButtonElement.prototype), \"connectedCallback\", this).call(this);\n      this.setAttribute('hotkey', 'i');\n    }\n  }]);\n  return MarkdownItalicButtonElement;\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-italic')) {\n  window.MarkdownItalicButtonElement = MarkdownItalicButtonElement;\n  window.customElements.define('md-italic', MarkdownItalicButtonElement);\n}\nvar MarkdownQuoteButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen4) {\n  _inherits(MarkdownQuoteButtonElement, _MarkdownButtonElemen4);\n  var _super5 = _createSuper(MarkdownQuoteButtonElement);\n  function MarkdownQuoteButtonElement() {\n    var _this5;\n    _classCallCheck(this, MarkdownQuoteButtonElement);\n    _this5 = _super5.call(this);\n    styles.set(_assertThisInitialized(_this5), {\n      prefix: '> ',\n      multiline: true,\n      surroundWithNewlines: true\n    });\n    return _this5;\n  }\n  return _createClass(MarkdownQuoteButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-quote')) {\n  window.MarkdownQuoteButtonElement = MarkdownQuoteButtonElement;\n  window.customElements.define('md-quote', MarkdownQuoteButtonElement);\n}\nvar MarkdownCodeButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen5) {\n  _inherits(MarkdownCodeButtonElement, _MarkdownButtonElemen5);\n  var _super6 = _createSuper(MarkdownCodeButtonElement);\n  function MarkdownCodeButtonElement() {\n    var _this6;\n    _classCallCheck(this, MarkdownCodeButtonElement);\n    _this6 = _super6.call(this);\n    styles.set(_assertThisInitialized(_this6), {\n      prefix: '`',\n      suffix: '`',\n      blockPrefix: '```',\n      blockSuffix: '```'\n    });\n    return _this6;\n  }\n  return _createClass(MarkdownCodeButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-code')) {\n  window.MarkdownCodeButtonElement = MarkdownCodeButtonElement;\n  window.customElements.define('md-code', MarkdownCodeButtonElement);\n}\nvar MarkdownLinkButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen6) {\n  _inherits(MarkdownLinkButtonElement, _MarkdownButtonElemen6);\n  var _super7 = _createSuper(MarkdownLinkButtonElement);\n  function MarkdownLinkButtonElement() {\n    var _this7;\n    _classCallCheck(this, MarkdownLinkButtonElement);\n    _this7 = _super7.call(this);\n    styles.set(_assertThisInitialized(_this7), {\n      prefix: '[',\n      suffix: '](url)',\n      replaceNext: 'url',\n      scanFor: 'https?://'\n    });\n    return _this7;\n  }\n  _createClass(MarkdownLinkButtonElement, [{\n    key: \"connectedCallback\",\n    value: function connectedCallback() {\n      _get(_getPrototypeOf(MarkdownLinkButtonElement.prototype), \"connectedCallback\", this).call(this);\n      this.setAttribute('hotkey', 'k');\n    }\n  }]);\n  return MarkdownLinkButtonElement;\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-link')) {\n  window.MarkdownLinkButtonElement = MarkdownLinkButtonElement;\n  window.customElements.define('md-link', MarkdownLinkButtonElement);\n}\nvar MarkdownImageButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen7) {\n  _inherits(MarkdownImageButtonElement, _MarkdownButtonElemen7);\n  var _super8 = _createSuper(MarkdownImageButtonElement);\n  function MarkdownImageButtonElement() {\n    var _this8;\n    _classCallCheck(this, MarkdownImageButtonElement);\n    _this8 = _super8.call(this);\n    styles.set(_assertThisInitialized(_this8), {\n      prefix: '![',\n      suffix: '](url)',\n      replaceNext: 'url',\n      scanFor: 'https?://'\n    });\n    return _this8;\n  }\n  return _createClass(MarkdownImageButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-image')) {\n  window.MarkdownImageButtonElement = MarkdownImageButtonElement;\n  window.customElements.define('md-image', MarkdownImageButtonElement);\n}\nvar MarkdownUnorderedListButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen8) {\n  _inherits(MarkdownUnorderedListButtonElement, _MarkdownButtonElemen8);\n  var _super9 = _createSuper(MarkdownUnorderedListButtonElement);\n  function MarkdownUnorderedListButtonElement() {\n    var _this9;\n    _classCallCheck(this, MarkdownUnorderedListButtonElement);\n    _this9 = _super9.call(this);\n    styles.set(_assertThisInitialized(_this9), {\n      prefix: '- ',\n      multiline: true,\n      surroundWithNewlines: true\n    });\n    return _this9;\n  }\n  return _createClass(MarkdownUnorderedListButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-unordered-list')) {\n  window.MarkdownUnorderedListButtonElement = MarkdownUnorderedListButtonElement;\n  window.customElements.define('md-unordered-list', MarkdownUnorderedListButtonElement);\n}\nvar MarkdownOrderedListButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen9) {\n  _inherits(MarkdownOrderedListButtonElement, _MarkdownButtonElemen9);\n  var _super10 = _createSuper(MarkdownOrderedListButtonElement);\n  function MarkdownOrderedListButtonElement() {\n    var _this10;\n    _classCallCheck(this, MarkdownOrderedListButtonElement);\n    _this10 = _super10.call(this);\n    styles.set(_assertThisInitialized(_this10), {\n      prefix: '1. ',\n      multiline: true,\n      orderedList: true\n    });\n    return _this10;\n  }\n  return _createClass(MarkdownOrderedListButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-ordered-list')) {\n  window.MarkdownOrderedListButtonElement = MarkdownOrderedListButtonElement;\n  window.customElements.define('md-ordered-list', MarkdownOrderedListButtonElement);\n}\nvar MarkdownTaskListButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen10) {\n  _inherits(MarkdownTaskListButtonElement, _MarkdownButtonElemen10);\n  var _super11 = _createSuper(MarkdownTaskListButtonElement);\n  function MarkdownTaskListButtonElement() {\n    var _this11;\n    _classCallCheck(this, MarkdownTaskListButtonElement);\n    _this11 = _super11.call(this);\n    styles.set(_assertThisInitialized(_this11), {\n      prefix: '- [ ] ',\n      multiline: true,\n      surroundWithNewlines: true\n    });\n    return _this11;\n  }\n  _createClass(MarkdownTaskListButtonElement, [{\n    key: \"connectedCallback\",\n    value: function connectedCallback() {\n      _get(_getPrototypeOf(MarkdownTaskListButtonElement.prototype), \"connectedCallback\", this).call(this);\n      this.setAttribute('hotkey', 'L');\n    }\n  }]);\n  return MarkdownTaskListButtonElement;\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-task-list')) {\n  window.MarkdownTaskListButtonElement = MarkdownTaskListButtonElement;\n  window.customElements.define('md-task-list', MarkdownTaskListButtonElement);\n}\nvar MarkdownMentionButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen11) {\n  _inherits(MarkdownMentionButtonElement, _MarkdownButtonElemen11);\n  var _super12 = _createSuper(MarkdownMentionButtonElement);\n  function MarkdownMentionButtonElement() {\n    var _this12;\n    _classCallCheck(this, MarkdownMentionButtonElement);\n    _this12 = _super12.call(this);\n    styles.set(_assertThisInitialized(_this12), {\n      prefix: '@',\n      prefixSpace: true\n    });\n    return _this12;\n  }\n  return _createClass(MarkdownMentionButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-mention')) {\n  window.MarkdownMentionButtonElement = MarkdownMentionButtonElement;\n  window.customElements.define('md-mention', MarkdownMentionButtonElement);\n}\nvar MarkdownRefButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen12) {\n  _inherits(MarkdownRefButtonElement, _MarkdownButtonElemen12);\n  var _super13 = _createSuper(MarkdownRefButtonElement);\n  function MarkdownRefButtonElement() {\n    var _this13;\n    _classCallCheck(this, MarkdownRefButtonElement);\n    _this13 = _super13.call(this);\n    styles.set(_assertThisInitialized(_this13), {\n      prefix: '#',\n      prefixSpace: true\n    });\n    return _this13;\n  }\n  return _createClass(MarkdownRefButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-ref')) {\n  window.MarkdownRefButtonElement = MarkdownRefButtonElement;\n  window.customElements.define('md-ref', MarkdownRefButtonElement);\n}\nvar MarkdownStrikethroughButtonElement = /*#__PURE__*/function (_MarkdownButtonElemen13) {\n  _inherits(MarkdownStrikethroughButtonElement, _MarkdownButtonElemen13);\n  var _super14 = _createSuper(MarkdownStrikethroughButtonElement);\n  function MarkdownStrikethroughButtonElement() {\n    var _this14;\n    _classCallCheck(this, MarkdownStrikethroughButtonElement);\n    _this14 = _super14.call(this);\n    styles.set(_assertThisInitialized(_this14), {\n      prefix: '~~',\n      suffix: '~~',\n      trimFirst: true\n    });\n    return _this14;\n  }\n  return _createClass(MarkdownStrikethroughButtonElement);\n}(MarkdownButtonElement);\nif (!window.customElements.get('md-strikethrough')) {\n  window.MarkdownStrikethroughButtonElement = MarkdownStrikethroughButtonElement;\n  window.customElements.define('md-strikethrough', MarkdownStrikethroughButtonElement);\n}\nvar modifierKey = navigator.userAgent.match(/Macintosh/) ? 'Meta' : 'Control';\nvar MarkdownToolbarElement = /*#__PURE__*/function (_HTMLElement2) {\n  _inherits(MarkdownToolbarElement, _HTMLElement2);\n  var _super15 = _createSuper(MarkdownToolbarElement);\n  function MarkdownToolbarElement() {\n    _classCallCheck(this, MarkdownToolbarElement);\n    return _super15.call(this);\n  }\n  _createClass(MarkdownToolbarElement, [{\n    key: \"connectedCallback\",\n    value: function connectedCallback() {\n      if (!this.hasAttribute('role')) {\n        this.setAttribute('role', 'toolbar');\n      }\n      this.addEventListener('keydown', focusKeydown);\n      var fn = shortcut.bind(null, this);\n      if (this.field) {\n        this.field.addEventListener('keydown', fn);\n        shortcutListeners.set(this, fn);\n      }\n      this.setAttribute('tabindex', '0');\n      this.addEventListener('focus', onToolbarFocus, {\n        once: true\n      });\n    }\n  }, {\n    key: \"disconnectedCallback\",\n    value: function disconnectedCallback() {\n      var fn = shortcutListeners.get(this);\n      if (fn && this.field) {\n        this.field.removeEventListener('keydown', fn);\n        shortcutListeners.delete(this);\n      }\n      this.removeEventListener('keydown', focusKeydown);\n    }\n  }, {\n    key: \"field\",\n    get: function get() {\n      var id = this.getAttribute('for');\n      if (!id) return null;\n      var root = 'getRootNode' in this ? this.getRootNode() : document;\n      var field;\n      if (root instanceof Document || root instanceof ShadowRoot) {\n        field = root.getElementById(id);\n      }\n      return field instanceof HTMLTextAreaElement ? field : null;\n    }\n  }]);\n  return MarkdownToolbarElement;\n}( /*#__PURE__*/_wrapNativeSuper(HTMLElement));\nfunction onToolbarFocus(_ref) {\n  var target = _ref.target;\n  if (!(target instanceof Element)) return;\n  target.removeAttribute('tabindex');\n  var tabindex = '0';\n  var _iterator2 = _createForOfIteratorHelper(getButtons(target)),\n    _step2;\n  try {\n    for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n      var button = _step2.value;\n      button.setAttribute('tabindex', tabindex);\n      if (tabindex === '0') {\n        button.focus();\n        tabindex = '-1';\n      }\n    }\n  } catch (err) {\n    _iterator2.e(err);\n  } finally {\n    _iterator2.f();\n  }\n}\nfunction focusKeydown(event) {\n  var key = event.key;\n  if (key !== 'ArrowRight' && key !== 'ArrowLeft' && key !== 'Home' && key !== 'End') return;\n  var toolbar = event.currentTarget;\n  if (!(toolbar instanceof HTMLElement)) return;\n  var buttons = getButtons(toolbar);\n  var index = buttons.indexOf(event.target);\n  var length = buttons.length;\n  if (index === -1) return;\n  var n = 0;\n  if (key === 'ArrowLeft') n = index - 1;\n  if (key === 'ArrowRight') n = index + 1;\n  if (key === 'End') n = length - 1;\n  if (n < 0) n = length - 1;\n  if (n > length - 1) n = 0;\n  for (var i = 0; i < length; i += 1) {\n    buttons[i].setAttribute('tabindex', i === n ? '0' : '-1');\n  }\n  event.preventDefault();\n  buttons[n].focus();\n}\nvar shortcutListeners = new WeakMap();\nfunction findHotkey(toolbar, key) {\n  var _iterator3 = _createForOfIteratorHelper(toolbar.querySelectorAll('[hotkey]')),\n    _step3;\n  try {\n    for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n      var el = _step3.value;\n      if (el.getAttribute('hotkey') === key) {\n        return el;\n      }\n    }\n  } catch (err) {\n    _iterator3.e(err);\n  } finally {\n    _iterator3.f();\n  }\n  return null;\n}\nfunction shortcut(toolbar, event) {\n  if (event.metaKey && modifierKey === 'Meta' || event.ctrlKey && modifierKey === 'Control') {\n    var button = findHotkey(toolbar, event.key);\n    if (button) {\n      button.click();\n      event.preventDefault();\n    }\n  }\n}\nif (!window.customElements.get('markdown-toolbar')) {\n  window.MarkdownToolbarElement = MarkdownToolbarElement;\n  window.customElements.define('markdown-toolbar', MarkdownToolbarElement);\n}\nfunction isMultipleLines(string) {\n  return string.trim().split('\\n').length > 1;\n}\nfunction repeat(string, n) {\n  return Array(n + 1).join(string);\n}\nfunction wordSelectionStart(text, i) {\n  var index = i;\n  while (text[index] && text[index - 1] != null && !text[index - 1].match(/\\s/)) {\n    index--;\n  }\n  return index;\n}\nfunction wordSelectionEnd(text, i, multiline) {\n  var index = i;\n  var breakpoint = multiline ? /\\n/ : /\\s/;\n  while (text[index] && !text[index].match(breakpoint)) {\n    index++;\n  }\n  return index;\n}\nvar canInsertText = null;\nfunction insertText(textarea, _ref2) {\n  var text = _ref2.text,\n    selectionStart = _ref2.selectionStart,\n    selectionEnd = _ref2.selectionEnd;\n  var originalSelectionStart = textarea.selectionStart;\n  var before = textarea.value.slice(0, originalSelectionStart);\n  var after = textarea.value.slice(textarea.selectionEnd);\n  if (canInsertText === null || canInsertText === true) {\n    textarea.contentEditable = 'true';\n    try {\n      canInsertText = document.execCommand('insertText', false, text);\n    } catch (error) {\n      canInsertText = false;\n    }\n    textarea.contentEditable = 'false';\n  }\n  if (canInsertText && !textarea.value.slice(0, textarea.selectionStart).endsWith(text)) {\n    canInsertText = false;\n  }\n  if (!canInsertText) {\n    try {\n      document.execCommand('ms-beginUndoUnit');\n    } catch (e) {}\n    textarea.value = before + text + after;\n    try {\n      document.execCommand('ms-endUndoUnit');\n    } catch (e) {}\n    textarea.dispatchEvent(new CustomEvent('input', {\n      bubbles: true,\n      cancelable: true\n    }));\n  }\n  if (selectionStart != null && selectionEnd != null) {\n    textarea.setSelectionRange(selectionStart, selectionEnd);\n  } else {\n    textarea.setSelectionRange(originalSelectionStart, textarea.selectionEnd);\n  }\n}\nfunction styleSelectedText(textarea, styleArgs) {\n  var text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  var result;\n  if (styleArgs.orderedList) {\n    result = orderedList(textarea);\n  } else if (styleArgs.multiline && isMultipleLines(text)) {\n    result = multilineStyle(textarea, styleArgs);\n  } else {\n    result = blockStyle(textarea, styleArgs);\n  }\n  insertText(textarea, result);\n}\nfunction expandSelectedText(textarea, prefixToUse, suffixToUse) {\n  var multiline = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  if (textarea.selectionStart === textarea.selectionEnd) {\n    textarea.selectionStart = wordSelectionStart(textarea.value, textarea.selectionStart);\n    textarea.selectionEnd = wordSelectionEnd(textarea.value, textarea.selectionEnd, multiline);\n  } else {\n    var expandedSelectionStart = textarea.selectionStart - prefixToUse.length;\n    var expandedSelectionEnd = textarea.selectionEnd + suffixToUse.length;\n    var beginsWithPrefix = textarea.value.slice(expandedSelectionStart, textarea.selectionStart) === prefixToUse;\n    var endsWithSuffix = textarea.value.slice(textarea.selectionEnd, expandedSelectionEnd) === suffixToUse;\n    if (beginsWithPrefix && endsWithSuffix) {\n      textarea.selectionStart = expandedSelectionStart;\n      textarea.selectionEnd = expandedSelectionEnd;\n    }\n  }\n  return textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n}\nfunction newlinesToSurroundSelectedText(textarea) {\n  var beforeSelection = textarea.value.slice(0, textarea.selectionStart);\n  var afterSelection = textarea.value.slice(textarea.selectionEnd);\n  var breaksBefore = beforeSelection.match(/\\n*$/);\n  var breaksAfter = afterSelection.match(/^\\n*/);\n  var newlinesBeforeSelection = breaksBefore ? breaksBefore[0].length : 0;\n  var newlinesAfterSelection = breaksAfter ? breaksAfter[0].length : 0;\n  var newlinesToAppend;\n  var newlinesToPrepend;\n  if (beforeSelection.match(/\\S/) && newlinesBeforeSelection < 2) {\n    newlinesToAppend = repeat('\\n', 2 - newlinesBeforeSelection);\n  }\n  if (afterSelection.match(/\\S/) && newlinesAfterSelection < 2) {\n    newlinesToPrepend = repeat('\\n', 2 - newlinesAfterSelection);\n  }\n  if (newlinesToAppend == null) {\n    newlinesToAppend = '';\n  }\n  if (newlinesToPrepend == null) {\n    newlinesToPrepend = '';\n  }\n  return {\n    newlinesToAppend: newlinesToAppend,\n    newlinesToPrepend: newlinesToPrepend\n  };\n}\nfunction blockStyle(textarea, arg) {\n  var newlinesToAppend;\n  var newlinesToPrepend;\n  var prefix = arg.prefix,\n    suffix = arg.suffix,\n    blockPrefix = arg.blockPrefix,\n    blockSuffix = arg.blockSuffix,\n    replaceNext = arg.replaceNext,\n    prefixSpace = arg.prefixSpace,\n    scanFor = arg.scanFor,\n    surroundWithNewlines = arg.surroundWithNewlines;\n  var originalSelectionStart = textarea.selectionStart;\n  var originalSelectionEnd = textarea.selectionEnd;\n  var selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  var prefixToUse = isMultipleLines(selectedText) && blockPrefix.length > 0 ? \"\".concat(blockPrefix, \"\\n\") : prefix;\n  var suffixToUse = isMultipleLines(selectedText) && blockSuffix.length > 0 ? \"\\n\".concat(blockSuffix) : suffix;\n  if (prefixSpace) {\n    var beforeSelection = textarea.value[textarea.selectionStart - 1];\n    if (textarea.selectionStart !== 0 && beforeSelection != null && !beforeSelection.match(/\\s/)) {\n      prefixToUse = \" \".concat(prefixToUse);\n    }\n  }\n  selectedText = expandSelectedText(textarea, prefixToUse, suffixToUse, arg.multiline);\n  var selectionStart = textarea.selectionStart;\n  var selectionEnd = textarea.selectionEnd;\n  var hasReplaceNext = replaceNext.length > 0 && suffixToUse.indexOf(replaceNext) > -1 && selectedText.length > 0;\n  if (surroundWithNewlines) {\n    var ref = newlinesToSurroundSelectedText(textarea);\n    newlinesToAppend = ref.newlinesToAppend;\n    newlinesToPrepend = ref.newlinesToPrepend;\n    prefixToUse = newlinesToAppend + prefix;\n    suffixToUse += newlinesToPrepend;\n  }\n  if (selectedText.startsWith(prefixToUse) && selectedText.endsWith(suffixToUse)) {\n    var replacementText = selectedText.slice(prefixToUse.length, selectedText.length - suffixToUse.length);\n    if (originalSelectionStart === originalSelectionEnd) {\n      var position = originalSelectionStart - prefixToUse.length;\n      position = Math.max(position, selectionStart);\n      position = Math.min(position, selectionStart + replacementText.length);\n      selectionStart = selectionEnd = position;\n    } else {\n      selectionEnd = selectionStart + replacementText.length;\n    }\n    return {\n      text: replacementText,\n      selectionStart: selectionStart,\n      selectionEnd: selectionEnd\n    };\n  } else if (!hasReplaceNext) {\n    var _replacementText = prefixToUse + selectedText + suffixToUse;\n    selectionStart = originalSelectionStart + prefixToUse.length;\n    selectionEnd = originalSelectionEnd + prefixToUse.length;\n    var whitespaceEdges = selectedText.match(/^\\s*|\\s*$/g);\n    if (arg.trimFirst && whitespaceEdges) {\n      var leadingWhitespace = whitespaceEdges[0] || '';\n      var trailingWhitespace = whitespaceEdges[1] || '';\n      _replacementText = leadingWhitespace + prefixToUse + selectedText.trim() + suffixToUse + trailingWhitespace;\n      selectionStart += leadingWhitespace.length;\n      selectionEnd -= trailingWhitespace.length;\n    }\n    return {\n      text: _replacementText,\n      selectionStart: selectionStart,\n      selectionEnd: selectionEnd\n    };\n  } else if (scanFor.length > 0 && selectedText.match(scanFor)) {\n    suffixToUse = suffixToUse.replace(replaceNext, selectedText);\n    var _replacementText2 = prefixToUse + suffixToUse;\n    selectionStart = selectionEnd = selectionStart + prefixToUse.length;\n    return {\n      text: _replacementText2,\n      selectionStart: selectionStart,\n      selectionEnd: selectionEnd\n    };\n  } else {\n    var _replacementText3 = prefixToUse + selectedText + suffixToUse;\n    selectionStart = selectionStart + prefixToUse.length + selectedText.length + suffixToUse.indexOf(replaceNext);\n    selectionEnd = selectionStart + replaceNext.length;\n    return {\n      text: _replacementText3,\n      selectionStart: selectionStart,\n      selectionEnd: selectionEnd\n    };\n  }\n}\nfunction multilineStyle(textarea, arg) {\n  var prefix = arg.prefix,\n    suffix = arg.suffix,\n    surroundWithNewlines = arg.surroundWithNewlines;\n  var text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  var selectionStart = textarea.selectionStart;\n  var selectionEnd = textarea.selectionEnd;\n  var lines = text.split('\\n');\n  var undoStyle = lines.every(function (line) {\n    return line.startsWith(prefix) && line.endsWith(suffix);\n  });\n  if (undoStyle) {\n    text = lines.map(function (line) {\n      return line.slice(prefix.length, line.length - suffix.length);\n    }).join('\\n');\n    selectionEnd = selectionStart + text.length;\n  } else {\n    text = lines.map(function (line) {\n      return prefix + line + suffix;\n    }).join('\\n');\n    if (surroundWithNewlines) {\n      var _newlinesToSurroundSe = newlinesToSurroundSelectedText(textarea),\n        newlinesToAppend = _newlinesToSurroundSe.newlinesToAppend,\n        newlinesToPrepend = _newlinesToSurroundSe.newlinesToPrepend;\n      selectionStart += newlinesToAppend.length;\n      selectionEnd = selectionStart + text.length;\n      text = newlinesToAppend + text + newlinesToPrepend;\n    }\n  }\n  return {\n    text: text,\n    selectionStart: selectionStart,\n    selectionEnd: selectionEnd\n  };\n}\nfunction orderedList(textarea) {\n  var orderedListRegex = /^\\d+\\.\\s+/;\n  var noInitialSelection = textarea.selectionStart === textarea.selectionEnd;\n  var selectionEnd;\n  var selectionStart;\n  var text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  var textToUnstyle = text;\n  var lines = text.split('\\n');\n  var startOfLine, endOfLine;\n  if (noInitialSelection) {\n    var linesBefore = textarea.value.slice(0, textarea.selectionStart).split(/\\n/);\n    startOfLine = textarea.selectionStart - linesBefore[linesBefore.length - 1].length;\n    endOfLine = wordSelectionEnd(textarea.value, textarea.selectionStart, true);\n    textToUnstyle = textarea.value.slice(startOfLine, endOfLine);\n  }\n  var linesToUnstyle = textToUnstyle.split('\\n');\n  var undoStyling = linesToUnstyle.every(function (line) {\n    return orderedListRegex.test(line);\n  });\n  if (undoStyling) {\n    lines = linesToUnstyle.map(function (line) {\n      return line.replace(orderedListRegex, '');\n    });\n    text = lines.join('\\n');\n    if (noInitialSelection && startOfLine && endOfLine) {\n      var lengthDiff = linesToUnstyle[0].length - lines[0].length;\n      selectionStart = selectionEnd = textarea.selectionStart - lengthDiff;\n      textarea.selectionStart = startOfLine;\n      textarea.selectionEnd = endOfLine;\n    }\n  } else {\n    lines = numberedLines(lines);\n    text = lines.join('\\n');\n    var _newlinesToSurroundSe2 = newlinesToSurroundSelectedText(textarea),\n      newlinesToAppend = _newlinesToSurroundSe2.newlinesToAppend,\n      newlinesToPrepend = _newlinesToSurroundSe2.newlinesToPrepend;\n    selectionStart = textarea.selectionStart + newlinesToAppend.length;\n    selectionEnd = selectionStart + text.length;\n    if (noInitialSelection) selectionStart = selectionEnd;\n    text = newlinesToAppend + text + newlinesToPrepend;\n  }\n  return {\n    text: text,\n    selectionStart: selectionStart,\n    selectionEnd: selectionEnd\n  };\n}\nfunction numberedLines(lines) {\n  var i;\n  var len;\n  var index;\n  var results = [];\n  for (index = i = 0, len = lines.length; i < len; index = ++i) {\n    var line = lines[index];\n    results.push(\"\".concat(index + 1, \". \").concat(line));\n  }\n  return results;\n}\nfunction applyStyle(button, stylesToApply) {\n  var toolbar = button.closest('markdown-toolbar');\n  if (!(toolbar instanceof MarkdownToolbarElement)) return;\n  var defaults = {\n    prefix: '',\n    suffix: '',\n    blockPrefix: '',\n    blockSuffix: '',\n    multiline: false,\n    replaceNext: '',\n    prefixSpace: false,\n    scanFor: '',\n    surroundWithNewlines: false,\n    orderedList: false,\n    trimFirst: false\n  };\n  var style = Object.assign(Object.assign({}, defaults), stylesToApply);\n  var field = toolbar.field;\n  if (field) {\n    field.focus();\n    styleSelectedText(field, style);\n  }\n}\nexport default MarkdownToolbarElement;","map":{"version":3,"names":["buttonSelectors","getButtons","toolbar","els","querySelectorAll","join","button","hidden","offsetWidth","offsetHeight","closest","push","keydown","fn","event","key","preventDefault","styles","WeakMap","MarkdownButtonElement","apply","style","get","applyStyle","addEventListener","hasAttribute","setAttribute","HTMLElement","MarkdownHeaderButtonElement","level","parseInt","getAttribute","prefix","repeat","set","window","customElements","define","MarkdownBoldButtonElement","suffix","trimFirst","MarkdownItalicButtonElement","MarkdownQuoteButtonElement","multiline","surroundWithNewlines","MarkdownCodeButtonElement","blockPrefix","blockSuffix","MarkdownLinkButtonElement","replaceNext","scanFor","MarkdownImageButtonElement","MarkdownUnorderedListButtonElement","MarkdownOrderedListButtonElement","orderedList","MarkdownTaskListButtonElement","MarkdownMentionButtonElement","prefixSpace","MarkdownRefButtonElement","MarkdownStrikethroughButtonElement","modifierKey","navigator","userAgent","match","MarkdownToolbarElement","focusKeydown","shortcut","bind","field","shortcutListeners","onToolbarFocus","once","removeEventListener","delete","id","root","getRootNode","document","Document","ShadowRoot","getElementById","HTMLTextAreaElement","target","Element","removeAttribute","tabindex","focus","currentTarget","buttons","index","indexOf","length","n","i","findHotkey","el","metaKey","ctrlKey","click","isMultipleLines","string","trim","split","Array","wordSelectionStart","text","wordSelectionEnd","breakpoint","canInsertText","insertText","textarea","selectionStart","selectionEnd","originalSelectionStart","before","value","slice","after","contentEditable","execCommand","error","endsWith","e","dispatchEvent","CustomEvent","bubbles","cancelable","setSelectionRange","styleSelectedText","styleArgs","result","multilineStyle","blockStyle","expandSelectedText","prefixToUse","suffixToUse","expandedSelectionStart","expandedSelectionEnd","beginsWithPrefix","endsWithSuffix","newlinesToSurroundSelectedText","beforeSelection","afterSelection","breaksBefore","breaksAfter","newlinesBeforeSelection","newlinesAfterSelection","newlinesToAppend","newlinesToPrepend","arg","originalSelectionEnd","selectedText","hasReplaceNext","ref","startsWith","replacementText","position","Math","max","min","whitespaceEdges","leadingWhitespace","trailingWhitespace","replace","lines","undoStyle","every","line","map","orderedListRegex","noInitialSelection","textToUnstyle","startOfLine","endOfLine","linesBefore","linesToUnstyle","undoStyling","test","lengthDiff","numberedLines","len","results","stylesToApply","defaults","Object","assign"],"sources":["D:/github/editor.io/node_modules/@github/markdown-toolbar-element/dist/index.js"],"sourcesContent":["const buttonSelectors = [\r\n    '[data-md-button]',\r\n    'md-header',\r\n    'md-bold',\r\n    'md-italic',\r\n    'md-quote',\r\n    'md-code',\r\n    'md-link',\r\n    'md-image',\r\n    'md-unordered-list',\r\n    'md-ordered-list',\r\n    'md-task-list',\r\n    'md-mention',\r\n    'md-ref',\r\n    'md-strikethrough'\r\n];\r\nfunction getButtons(toolbar) {\r\n    const els = [];\r\n    for (const button of toolbar.querySelectorAll(buttonSelectors.join(', '))) {\r\n        if (button.hidden || (button.offsetWidth <= 0 && button.offsetHeight <= 0))\r\n            continue;\r\n        if (button.closest('markdown-toolbar') === toolbar)\r\n            els.push(button);\r\n    }\r\n    return els;\r\n}\r\nfunction keydown(fn) {\r\n    return function (event) {\r\n        if (event.key === ' ' || event.key === 'Enter') {\r\n            event.preventDefault();\r\n            fn(event);\r\n        }\r\n    };\r\n}\r\nconst styles = new WeakMap();\r\nclass MarkdownButtonElement extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n        const apply = () => {\r\n            const style = styles.get(this);\r\n            if (!style)\r\n                return;\r\n            applyStyle(this, style);\r\n        };\r\n        this.addEventListener('keydown', keydown(apply));\r\n        this.addEventListener('click', apply);\r\n    }\r\n    connectedCallback() {\r\n        if (!this.hasAttribute('role')) {\r\n            this.setAttribute('role', 'button');\r\n        }\r\n    }\r\n    click() {\r\n        const style = styles.get(this);\r\n        if (!style)\r\n            return;\r\n        applyStyle(this, style);\r\n    }\r\n}\r\nclass MarkdownHeaderButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        const level = parseInt(this.getAttribute('level') || '3', 10);\r\n        if (level < 1 || level > 6) {\r\n            return;\r\n        }\r\n        const prefix = `${'#'.repeat(level)} `;\r\n        styles.set(this, {\r\n            prefix\r\n        });\r\n    }\r\n}\r\nif (!window.customElements.get('md-header')) {\r\n    window.MarkdownHeaderButtonElement = MarkdownHeaderButtonElement;\r\n    window.customElements.define('md-header', MarkdownHeaderButtonElement);\r\n}\r\nclass MarkdownBoldButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '**', suffix: '**', trimFirst: true });\r\n    }\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.setAttribute('hotkey', 'b');\r\n    }\r\n}\r\nif (!window.customElements.get('md-bold')) {\r\n    window.MarkdownBoldButtonElement = MarkdownBoldButtonElement;\r\n    window.customElements.define('md-bold', MarkdownBoldButtonElement);\r\n}\r\nclass MarkdownItalicButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '_', suffix: '_', trimFirst: true });\r\n    }\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.setAttribute('hotkey', 'i');\r\n    }\r\n}\r\nif (!window.customElements.get('md-italic')) {\r\n    window.MarkdownItalicButtonElement = MarkdownItalicButtonElement;\r\n    window.customElements.define('md-italic', MarkdownItalicButtonElement);\r\n}\r\nclass MarkdownQuoteButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '> ', multiline: true, surroundWithNewlines: true });\r\n    }\r\n}\r\nif (!window.customElements.get('md-quote')) {\r\n    window.MarkdownQuoteButtonElement = MarkdownQuoteButtonElement;\r\n    window.customElements.define('md-quote', MarkdownQuoteButtonElement);\r\n}\r\nclass MarkdownCodeButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '`', suffix: '`', blockPrefix: '```', blockSuffix: '```' });\r\n    }\r\n}\r\nif (!window.customElements.get('md-code')) {\r\n    window.MarkdownCodeButtonElement = MarkdownCodeButtonElement;\r\n    window.customElements.define('md-code', MarkdownCodeButtonElement);\r\n}\r\nclass MarkdownLinkButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '[', suffix: '](url)', replaceNext: 'url', scanFor: 'https?://' });\r\n    }\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.setAttribute('hotkey', 'k');\r\n    }\r\n}\r\nif (!window.customElements.get('md-link')) {\r\n    window.MarkdownLinkButtonElement = MarkdownLinkButtonElement;\r\n    window.customElements.define('md-link', MarkdownLinkButtonElement);\r\n}\r\nclass MarkdownImageButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '![', suffix: '](url)', replaceNext: 'url', scanFor: 'https?://' });\r\n    }\r\n}\r\nif (!window.customElements.get('md-image')) {\r\n    window.MarkdownImageButtonElement = MarkdownImageButtonElement;\r\n    window.customElements.define('md-image', MarkdownImageButtonElement);\r\n}\r\nclass MarkdownUnorderedListButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '- ', multiline: true, surroundWithNewlines: true });\r\n    }\r\n}\r\nif (!window.customElements.get('md-unordered-list')) {\r\n    window.MarkdownUnorderedListButtonElement = MarkdownUnorderedListButtonElement;\r\n    window.customElements.define('md-unordered-list', MarkdownUnorderedListButtonElement);\r\n}\r\nclass MarkdownOrderedListButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '1. ', multiline: true, orderedList: true });\r\n    }\r\n}\r\nif (!window.customElements.get('md-ordered-list')) {\r\n    window.MarkdownOrderedListButtonElement = MarkdownOrderedListButtonElement;\r\n    window.customElements.define('md-ordered-list', MarkdownOrderedListButtonElement);\r\n}\r\nclass MarkdownTaskListButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '- [ ] ', multiline: true, surroundWithNewlines: true });\r\n    }\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.setAttribute('hotkey', 'L');\r\n    }\r\n}\r\nif (!window.customElements.get('md-task-list')) {\r\n    window.MarkdownTaskListButtonElement = MarkdownTaskListButtonElement;\r\n    window.customElements.define('md-task-list', MarkdownTaskListButtonElement);\r\n}\r\nclass MarkdownMentionButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '@', prefixSpace: true });\r\n    }\r\n}\r\nif (!window.customElements.get('md-mention')) {\r\n    window.MarkdownMentionButtonElement = MarkdownMentionButtonElement;\r\n    window.customElements.define('md-mention', MarkdownMentionButtonElement);\r\n}\r\nclass MarkdownRefButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '#', prefixSpace: true });\r\n    }\r\n}\r\nif (!window.customElements.get('md-ref')) {\r\n    window.MarkdownRefButtonElement = MarkdownRefButtonElement;\r\n    window.customElements.define('md-ref', MarkdownRefButtonElement);\r\n}\r\nclass MarkdownStrikethroughButtonElement extends MarkdownButtonElement {\r\n    constructor() {\r\n        super();\r\n        styles.set(this, { prefix: '~~', suffix: '~~', trimFirst: true });\r\n    }\r\n}\r\nif (!window.customElements.get('md-strikethrough')) {\r\n    window.MarkdownStrikethroughButtonElement = MarkdownStrikethroughButtonElement;\r\n    window.customElements.define('md-strikethrough', MarkdownStrikethroughButtonElement);\r\n}\r\nconst modifierKey = navigator.userAgent.match(/Macintosh/) ? 'Meta' : 'Control';\r\nclass MarkdownToolbarElement extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n    }\r\n    connectedCallback() {\r\n        if (!this.hasAttribute('role')) {\r\n            this.setAttribute('role', 'toolbar');\r\n        }\r\n        this.addEventListener('keydown', focusKeydown);\r\n        const fn = shortcut.bind(null, this);\r\n        if (this.field) {\r\n            this.field.addEventListener('keydown', fn);\r\n            shortcutListeners.set(this, fn);\r\n        }\r\n        this.setAttribute('tabindex', '0');\r\n        this.addEventListener('focus', onToolbarFocus, { once: true });\r\n    }\r\n    disconnectedCallback() {\r\n        const fn = shortcutListeners.get(this);\r\n        if (fn && this.field) {\r\n            this.field.removeEventListener('keydown', fn);\r\n            shortcutListeners.delete(this);\r\n        }\r\n        this.removeEventListener('keydown', focusKeydown);\r\n    }\r\n    get field() {\r\n        const id = this.getAttribute('for');\r\n        if (!id)\r\n            return null;\r\n        const root = 'getRootNode' in this ? this.getRootNode() : document;\r\n        let field;\r\n        if (root instanceof Document || root instanceof ShadowRoot) {\r\n            field = root.getElementById(id);\r\n        }\r\n        return field instanceof HTMLTextAreaElement ? field : null;\r\n    }\r\n}\r\nfunction onToolbarFocus({ target }) {\r\n    if (!(target instanceof Element))\r\n        return;\r\n    target.removeAttribute('tabindex');\r\n    let tabindex = '0';\r\n    for (const button of getButtons(target)) {\r\n        button.setAttribute('tabindex', tabindex);\r\n        if (tabindex === '0') {\r\n            button.focus();\r\n            tabindex = '-1';\r\n        }\r\n    }\r\n}\r\nfunction focusKeydown(event) {\r\n    const key = event.key;\r\n    if (key !== 'ArrowRight' && key !== 'ArrowLeft' && key !== 'Home' && key !== 'End')\r\n        return;\r\n    const toolbar = event.currentTarget;\r\n    if (!(toolbar instanceof HTMLElement))\r\n        return;\r\n    const buttons = getButtons(toolbar);\r\n    const index = buttons.indexOf(event.target);\r\n    const length = buttons.length;\r\n    if (index === -1)\r\n        return;\r\n    let n = 0;\r\n    if (key === 'ArrowLeft')\r\n        n = index - 1;\r\n    if (key === 'ArrowRight')\r\n        n = index + 1;\r\n    if (key === 'End')\r\n        n = length - 1;\r\n    if (n < 0)\r\n        n = length - 1;\r\n    if (n > length - 1)\r\n        n = 0;\r\n    for (let i = 0; i < length; i += 1) {\r\n        buttons[i].setAttribute('tabindex', i === n ? '0' : '-1');\r\n    }\r\n    event.preventDefault();\r\n    buttons[n].focus();\r\n}\r\nconst shortcutListeners = new WeakMap();\r\nfunction findHotkey(toolbar, key) {\r\n    for (const el of toolbar.querySelectorAll('[hotkey]')) {\r\n        if (el.getAttribute('hotkey') === key) {\r\n            return el;\r\n        }\r\n    }\r\n    return null;\r\n}\r\nfunction shortcut(toolbar, event) {\r\n    if ((event.metaKey && modifierKey === 'Meta') || (event.ctrlKey && modifierKey === 'Control')) {\r\n        const button = findHotkey(toolbar, event.key);\r\n        if (button) {\r\n            button.click();\r\n            event.preventDefault();\r\n        }\r\n    }\r\n}\r\nif (!window.customElements.get('markdown-toolbar')) {\r\n    window.MarkdownToolbarElement = MarkdownToolbarElement;\r\n    window.customElements.define('markdown-toolbar', MarkdownToolbarElement);\r\n}\r\nfunction isMultipleLines(string) {\r\n    return string.trim().split('\\n').length > 1;\r\n}\r\nfunction repeat(string, n) {\r\n    return Array(n + 1).join(string);\r\n}\r\nfunction wordSelectionStart(text, i) {\r\n    let index = i;\r\n    while (text[index] && text[index - 1] != null && !text[index - 1].match(/\\s/)) {\r\n        index--;\r\n    }\r\n    return index;\r\n}\r\nfunction wordSelectionEnd(text, i, multiline) {\r\n    let index = i;\r\n    const breakpoint = multiline ? /\\n/ : /\\s/;\r\n    while (text[index] && !text[index].match(breakpoint)) {\r\n        index++;\r\n    }\r\n    return index;\r\n}\r\nlet canInsertText = null;\r\nfunction insertText(textarea, { text, selectionStart, selectionEnd }) {\r\n    const originalSelectionStart = textarea.selectionStart;\r\n    const before = textarea.value.slice(0, originalSelectionStart);\r\n    const after = textarea.value.slice(textarea.selectionEnd);\r\n    if (canInsertText === null || canInsertText === true) {\r\n        textarea.contentEditable = 'true';\r\n        try {\r\n            canInsertText = document.execCommand('insertText', false, text);\r\n        }\r\n        catch (error) {\r\n            canInsertText = false;\r\n        }\r\n        textarea.contentEditable = 'false';\r\n    }\r\n    if (canInsertText && !textarea.value.slice(0, textarea.selectionStart).endsWith(text)) {\r\n        canInsertText = false;\r\n    }\r\n    if (!canInsertText) {\r\n        try {\r\n            document.execCommand('ms-beginUndoUnit');\r\n        }\r\n        catch (e) {\r\n        }\r\n        textarea.value = before + text + after;\r\n        try {\r\n            document.execCommand('ms-endUndoUnit');\r\n        }\r\n        catch (e) {\r\n        }\r\n        textarea.dispatchEvent(new CustomEvent('input', { bubbles: true, cancelable: true }));\r\n    }\r\n    if (selectionStart != null && selectionEnd != null) {\r\n        textarea.setSelectionRange(selectionStart, selectionEnd);\r\n    }\r\n    else {\r\n        textarea.setSelectionRange(originalSelectionStart, textarea.selectionEnd);\r\n    }\r\n}\r\nfunction styleSelectedText(textarea, styleArgs) {\r\n    const text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\r\n    let result;\r\n    if (styleArgs.orderedList) {\r\n        result = orderedList(textarea);\r\n    }\r\n    else if (styleArgs.multiline && isMultipleLines(text)) {\r\n        result = multilineStyle(textarea, styleArgs);\r\n    }\r\n    else {\r\n        result = blockStyle(textarea, styleArgs);\r\n    }\r\n    insertText(textarea, result);\r\n}\r\nfunction expandSelectedText(textarea, prefixToUse, suffixToUse, multiline = false) {\r\n    if (textarea.selectionStart === textarea.selectionEnd) {\r\n        textarea.selectionStart = wordSelectionStart(textarea.value, textarea.selectionStart);\r\n        textarea.selectionEnd = wordSelectionEnd(textarea.value, textarea.selectionEnd, multiline);\r\n    }\r\n    else {\r\n        const expandedSelectionStart = textarea.selectionStart - prefixToUse.length;\r\n        const expandedSelectionEnd = textarea.selectionEnd + suffixToUse.length;\r\n        const beginsWithPrefix = textarea.value.slice(expandedSelectionStart, textarea.selectionStart) === prefixToUse;\r\n        const endsWithSuffix = textarea.value.slice(textarea.selectionEnd, expandedSelectionEnd) === suffixToUse;\r\n        if (beginsWithPrefix && endsWithSuffix) {\r\n            textarea.selectionStart = expandedSelectionStart;\r\n            textarea.selectionEnd = expandedSelectionEnd;\r\n        }\r\n    }\r\n    return textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\r\n}\r\nfunction newlinesToSurroundSelectedText(textarea) {\r\n    const beforeSelection = textarea.value.slice(0, textarea.selectionStart);\r\n    const afterSelection = textarea.value.slice(textarea.selectionEnd);\r\n    const breaksBefore = beforeSelection.match(/\\n*$/);\r\n    const breaksAfter = afterSelection.match(/^\\n*/);\r\n    const newlinesBeforeSelection = breaksBefore ? breaksBefore[0].length : 0;\r\n    const newlinesAfterSelection = breaksAfter ? breaksAfter[0].length : 0;\r\n    let newlinesToAppend;\r\n    let newlinesToPrepend;\r\n    if (beforeSelection.match(/\\S/) && newlinesBeforeSelection < 2) {\r\n        newlinesToAppend = repeat('\\n', 2 - newlinesBeforeSelection);\r\n    }\r\n    if (afterSelection.match(/\\S/) && newlinesAfterSelection < 2) {\r\n        newlinesToPrepend = repeat('\\n', 2 - newlinesAfterSelection);\r\n    }\r\n    if (newlinesToAppend == null) {\r\n        newlinesToAppend = '';\r\n    }\r\n    if (newlinesToPrepend == null) {\r\n        newlinesToPrepend = '';\r\n    }\r\n    return { newlinesToAppend, newlinesToPrepend };\r\n}\r\nfunction blockStyle(textarea, arg) {\r\n    let newlinesToAppend;\r\n    let newlinesToPrepend;\r\n    const { prefix, suffix, blockPrefix, blockSuffix, replaceNext, prefixSpace, scanFor, surroundWithNewlines } = arg;\r\n    const originalSelectionStart = textarea.selectionStart;\r\n    const originalSelectionEnd = textarea.selectionEnd;\r\n    let selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\r\n    let prefixToUse = isMultipleLines(selectedText) && blockPrefix.length > 0 ? `${blockPrefix}\\n` : prefix;\r\n    let suffixToUse = isMultipleLines(selectedText) && blockSuffix.length > 0 ? `\\n${blockSuffix}` : suffix;\r\n    if (prefixSpace) {\r\n        const beforeSelection = textarea.value[textarea.selectionStart - 1];\r\n        if (textarea.selectionStart !== 0 && beforeSelection != null && !beforeSelection.match(/\\s/)) {\r\n            prefixToUse = ` ${prefixToUse}`;\r\n        }\r\n    }\r\n    selectedText = expandSelectedText(textarea, prefixToUse, suffixToUse, arg.multiline);\r\n    let selectionStart = textarea.selectionStart;\r\n    let selectionEnd = textarea.selectionEnd;\r\n    const hasReplaceNext = replaceNext.length > 0 && suffixToUse.indexOf(replaceNext) > -1 && selectedText.length > 0;\r\n    if (surroundWithNewlines) {\r\n        const ref = newlinesToSurroundSelectedText(textarea);\r\n        newlinesToAppend = ref.newlinesToAppend;\r\n        newlinesToPrepend = ref.newlinesToPrepend;\r\n        prefixToUse = newlinesToAppend + prefix;\r\n        suffixToUse += newlinesToPrepend;\r\n    }\r\n    if (selectedText.startsWith(prefixToUse) && selectedText.endsWith(suffixToUse)) {\r\n        const replacementText = selectedText.slice(prefixToUse.length, selectedText.length - suffixToUse.length);\r\n        if (originalSelectionStart === originalSelectionEnd) {\r\n            let position = originalSelectionStart - prefixToUse.length;\r\n            position = Math.max(position, selectionStart);\r\n            position = Math.min(position, selectionStart + replacementText.length);\r\n            selectionStart = selectionEnd = position;\r\n        }\r\n        else {\r\n            selectionEnd = selectionStart + replacementText.length;\r\n        }\r\n        return { text: replacementText, selectionStart, selectionEnd };\r\n    }\r\n    else if (!hasReplaceNext) {\r\n        let replacementText = prefixToUse + selectedText + suffixToUse;\r\n        selectionStart = originalSelectionStart + prefixToUse.length;\r\n        selectionEnd = originalSelectionEnd + prefixToUse.length;\r\n        const whitespaceEdges = selectedText.match(/^\\s*|\\s*$/g);\r\n        if (arg.trimFirst && whitespaceEdges) {\r\n            const leadingWhitespace = whitespaceEdges[0] || '';\r\n            const trailingWhitespace = whitespaceEdges[1] || '';\r\n            replacementText = leadingWhitespace + prefixToUse + selectedText.trim() + suffixToUse + trailingWhitespace;\r\n            selectionStart += leadingWhitespace.length;\r\n            selectionEnd -= trailingWhitespace.length;\r\n        }\r\n        return { text: replacementText, selectionStart, selectionEnd };\r\n    }\r\n    else if (scanFor.length > 0 && selectedText.match(scanFor)) {\r\n        suffixToUse = suffixToUse.replace(replaceNext, selectedText);\r\n        const replacementText = prefixToUse + suffixToUse;\r\n        selectionStart = selectionEnd = selectionStart + prefixToUse.length;\r\n        return { text: replacementText, selectionStart, selectionEnd };\r\n    }\r\n    else {\r\n        const replacementText = prefixToUse + selectedText + suffixToUse;\r\n        selectionStart = selectionStart + prefixToUse.length + selectedText.length + suffixToUse.indexOf(replaceNext);\r\n        selectionEnd = selectionStart + replaceNext.length;\r\n        return { text: replacementText, selectionStart, selectionEnd };\r\n    }\r\n}\r\nfunction multilineStyle(textarea, arg) {\r\n    const { prefix, suffix, surroundWithNewlines } = arg;\r\n    let text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\r\n    let selectionStart = textarea.selectionStart;\r\n    let selectionEnd = textarea.selectionEnd;\r\n    const lines = text.split('\\n');\r\n    const undoStyle = lines.every(line => line.startsWith(prefix) && line.endsWith(suffix));\r\n    if (undoStyle) {\r\n        text = lines.map(line => line.slice(prefix.length, line.length - suffix.length)).join('\\n');\r\n        selectionEnd = selectionStart + text.length;\r\n    }\r\n    else {\r\n        text = lines.map(line => prefix + line + suffix).join('\\n');\r\n        if (surroundWithNewlines) {\r\n            const { newlinesToAppend, newlinesToPrepend } = newlinesToSurroundSelectedText(textarea);\r\n            selectionStart += newlinesToAppend.length;\r\n            selectionEnd = selectionStart + text.length;\r\n            text = newlinesToAppend + text + newlinesToPrepend;\r\n        }\r\n    }\r\n    return { text, selectionStart, selectionEnd };\r\n}\r\nfunction orderedList(textarea) {\r\n    const orderedListRegex = /^\\d+\\.\\s+/;\r\n    const noInitialSelection = textarea.selectionStart === textarea.selectionEnd;\r\n    let selectionEnd;\r\n    let selectionStart;\r\n    let text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\r\n    let textToUnstyle = text;\r\n    let lines = text.split('\\n');\r\n    let startOfLine, endOfLine;\r\n    if (noInitialSelection) {\r\n        const linesBefore = textarea.value.slice(0, textarea.selectionStart).split(/\\n/);\r\n        startOfLine = textarea.selectionStart - linesBefore[linesBefore.length - 1].length;\r\n        endOfLine = wordSelectionEnd(textarea.value, textarea.selectionStart, true);\r\n        textToUnstyle = textarea.value.slice(startOfLine, endOfLine);\r\n    }\r\n    const linesToUnstyle = textToUnstyle.split('\\n');\r\n    const undoStyling = linesToUnstyle.every(line => orderedListRegex.test(line));\r\n    if (undoStyling) {\r\n        lines = linesToUnstyle.map(line => line.replace(orderedListRegex, ''));\r\n        text = lines.join('\\n');\r\n        if (noInitialSelection && startOfLine && endOfLine) {\r\n            const lengthDiff = linesToUnstyle[0].length - lines[0].length;\r\n            selectionStart = selectionEnd = textarea.selectionStart - lengthDiff;\r\n            textarea.selectionStart = startOfLine;\r\n            textarea.selectionEnd = endOfLine;\r\n        }\r\n    }\r\n    else {\r\n        lines = numberedLines(lines);\r\n        text = lines.join('\\n');\r\n        const { newlinesToAppend, newlinesToPrepend } = newlinesToSurroundSelectedText(textarea);\r\n        selectionStart = textarea.selectionStart + newlinesToAppend.length;\r\n        selectionEnd = selectionStart + text.length;\r\n        if (noInitialSelection)\r\n            selectionStart = selectionEnd;\r\n        text = newlinesToAppend + text + newlinesToPrepend;\r\n    }\r\n    return { text, selectionStart, selectionEnd };\r\n}\r\nfunction numberedLines(lines) {\r\n    let i;\r\n    let len;\r\n    let index;\r\n    const results = [];\r\n    for (index = i = 0, len = lines.length; i < len; index = ++i) {\r\n        const line = lines[index];\r\n        results.push(`${index + 1}. ${line}`);\r\n    }\r\n    return results;\r\n}\r\nfunction applyStyle(button, stylesToApply) {\r\n    const toolbar = button.closest('markdown-toolbar');\r\n    if (!(toolbar instanceof MarkdownToolbarElement))\r\n        return;\r\n    const defaults = {\r\n        prefix: '',\r\n        suffix: '',\r\n        blockPrefix: '',\r\n        blockSuffix: '',\r\n        multiline: false,\r\n        replaceNext: '',\r\n        prefixSpace: false,\r\n        scanFor: '',\r\n        surroundWithNewlines: false,\r\n        orderedList: false,\r\n        trimFirst: false\r\n    };\r\n    const style = Object.assign(Object.assign({}, defaults), stylesToApply);\r\n    const field = toolbar.field;\r\n    if (field) {\r\n        field.focus();\r\n        styleSelectedText(field, style);\r\n    }\r\n}\r\nexport default MarkdownToolbarElement;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}